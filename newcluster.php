<?php

require_once(dirname(__FILE__) . '/config.inc.php');
require_once(dirname(__FILE__) . '/adodb5/adodb.inc.php');

//----------------------------------------------------------------------------------------

$parents = array();

function makeset($x) {
	global $parents;
	
	$parents[$x] = $x;
}

function find($x) {
	global $parents;
	
	if ($x == $parents[$x]) {
		return $x;
	} else {
		return find($parents[$x]);
	}
}

function union($x, $y) {
	global $parents;
	
	$x_root = find($x);
	$y_root = find($y);
	$parents[$x_root] = $y_root;
	
}



//--------------------------------------------------------------------------------------------------
$db = NewADOConnection('mysql');
$db->Connect("localhost", 
	$config['db_user'] , $config['db_passwd'] , $config['db_name']);

// Ensure fields are (only) indexed by column name
$ADODB_FETCH_MODE = ADODB_FETCH_ASSOC;

$db->EXECUTE("set names 'utf8'"); 


$genera = array('Acanthopsis',
'Andrographis',
'Asystasia',
'Beloperone',
'Chaetothylax',
'Dianthera',
'Acer',
'Adiantopsis',
'Adiantum',
'Aleuritopteris',
'Allosurus',
'Cryptogramma',
'Jamesonia',
'Onychium',
'Pellaea',
'Pentagramma',
'Polianthes',
'Daggodora',
'Dinteranthus',
'Drosanthemopsis',
'Komsbergella',
'Sanianthos',
'Alangium',
'Allium',
'Dipterostemon',
'Aloe',
'Gastonialoe',
'Tulista',
'Alstroemeria',
'Achyropsis',
'Aerva',
'Alternanthera',
'Amaranthus',
'Arthrocaulon',
'Arthroceras',
'Belowia',
'Philoxerus',
'Wadithamnus',
'Apodolirion',
'Myostemma',
'Narcissus',
'Phaedranassa',
'Zephyranthes',
'Mauria',
'Afroguatteria',
'Alphonsea',
'Goniothalamus',
'Miliusa',
'Monanthotaxis',
'Oxandra',
'Sphaerocoryne',
'Wangia',
'Xylopia',
'Chlorophytum',
'Thysanotus',
'Angelica',
'Annesorhiza',
'Conium',
'Cymbocarpum',
'Hydrocotyle',
'Lomatium',
'Normantha',
'Pastinaca',
'Pimpinella',
'Seseli',
'Sillaphyton',
'Sium',
'Smyrnium',
'Anemotrochus',
'Apocynum',
'Poacynum',
'Ilex',
'Alocasia',
'Biarum',
'Dieffenbachia',
'Ooia',
'Schismatoglottis',
'Aralia',
'Botryodendrum',
'Brassaiopsis',
'Dendropanax',
'Hedera',
'Heptapleurum',
'Kalopanax',
'Macropanax',
'Panax',
'Schefflera',
'Aiphanes',
'Areca',
'Attalea',
'Guihaia',
'Pholidostachys',
'Syagrus',
'Synechanthus',
'Aristolochia',
'Asarum',
'Aspidoglossum',
'Brachystelma',
'Ceropegia',
'Cynanchum',
'Heterostemma',
'Hoya',
'Matelea',
'Periglossum',
'Piaranthus',
'Tylodontia',
'Vincetoxicum',
'Asparagus',
'Eremurus',
'Asplenium',
'Achillea',
'Ageratum',
'Anacyclus',
'Aplotaxis',
'Baccharis',
'Centaurea',
'Chrysocephalum',
'Cirsium',
'Cremanthodium',
'Distephanus',
'Erigeron',
'Espeletia',
'Eupatorium',
'Gnaphalium',
'Gundelia',
'Gutierrezia',
'Helianthus',
'Helichrysum',
'Hieracium',
'Humbertacalia',
'Hymenothrix',
'Isocarpha',
'Lagenophora',
'Lanugothamnus',
'Lapidia',
'Launaea',
'Liabum',
'Ligularia',
'Lomanthus',
'Macroclinidium',
'Madacarpus',
'Maschalostachys',
'Mikania',
'Munnozia',
'Nothoschkuhria',
'Parasenecio',
'Pertya',
'Perymenium',
'Petasites',
'Picradeniopsis',
'Pilosella',
'Podachaenium',
'Santolina',
'Saussurea',
'Senecio',
'Solidago',
'Symphyotrichum',
'Synotis',
'Taraxacum',
'Tridax',
'Turanecio',
'Verbesina',
'Vernonanthura',
'Vernonia',
'Balanophora',
'Impatiens',
'Begonia',
'Berberis',
'Epimedium',
'Alnus',
'Adenocalymma',
'Jacaranda',
'Neojobertia',
'Phyllarthron',
'Tanaecium',
'Blechnum',
'Parablechnum',
'Andersonglossum',
'Cryptantha',
'Eritrichium',
'Euploca',
'Iberodes',
'Mapuchea',
'Mimophytum',
'Omphalodes',
'Onosma',
'Tournefortia',
'Trigonotis',
'Alyssum',
'Anzhengxia',
'Asta',
'Biscutella',
'Boechera',
'Brassica',
'Brassica-napus',
'Descurainia',
'Draba',
'Erysimum',
'Eutrema',
'Hormathophylla',
'Lepidium',
'Matthiola',
'Metashangrilaia',
'Noccaea',
'Pterolobium',
'Raphanus',
'Rudolf-kamelinia',
'Barfussia',
'Bromelia',
'Goudaea',
'Gregbrownia',
'Guzmania',
'Jagrantia',
'Josemania',
'Lemeltonia',
'Lutheria',
'Pitcairnia',
'Pseudalcantarea',
'Puya',
'Racinaea',
'Sincoraea',
'Steyerbromelia',
'Stigmatodon',
'Tillandsia',
'Vriesea',
'Wallisia',
'Zizkaea',
'Barrera',
'Thismia',
'Bursera',
'Commiphora',
'Dacryodes',
'Protium',
'Bolivicereus',
'Bolivihanburya',
'Borzicereus',
'Corynopuntia',
'Echinocactus',
'Echinocereus',
'Escobaria',
'Mammillaria',
'Mariottia',
'Morawetzia',
'Opuntia',
'Polascontria',
'Stenocereus',
'Wittiocactus',
'Tachigali',
'Campanulastrum',
'Lobelia',
'Lysipomia',
'Wahlenbergia',
'Abelia',
'Viburnum',
'Acanthophyllum',
'Arenaria',
'Cerastium',
'Coromelandrum',
'Gypsophila',
'Odontostemma',
'Polycarpaea',
'Sabulina',
'Sagina',
'Silene',
'Solitaria',
'Stellaria',
'Allocasuarina',
'Crossopetalum',
'Reissantia',
'Cercidiphyllum',
'Chenopodium',
'Dysphania',
'Lipandra',
'Petrosimonia',
'Salicornia',
'Caraipa',
'Clusia',
'Garcinia',
'Hypericum',
'Tovomita',
'Colchicum',
'Commelina',
'Murdannia',
'Tradescantia',
'Aspidistra',
'Tricyrtis',
'Argyreia',
'Convolvulus',
'Ipomoea',
'Rivea',
'Cornus',
'Carpinus',
'Costus',
'Dudleya',
'Echeveria',
'Hylostachys',
'Petrosedum',
'Reidmorania',
'Sedum',
'Telephium',
'Lagenaria',
'Luffa',
'Momordica',
'Trichosanthes',
'Callitris',
'Cyathea',
'Cycas',
'Carex',
'Cyperus',
'Ficinia',
'Mapania',
'Rhynchospora',
'Schoenus',
'Davallia',
'Katoella',
'Dennstaedtia',
'Lindsaea',
'Microlepia',
'Odontosoria',
'Pteridium',
'Shortia',
'Tapura',
'Dioscorea',
'Cephalaria',
'Dracaena',
'Sansevieria',
'Dryopteris',
'Pleocnemia',
'Polystichum',
'Tectaria',
'Diospyros',
'Elatine',
'Leucopogon',
'Stenanthera',
'Equisetum',
'Agapetes',
'Diplycosia',
'Erica',
'Rhododendron',
'Vaccinium',
'Eriocaulon',
'Actephila',
'Aemaralmeida',
'Breynia',
'Croton',
'Dalechampia',
'Euphorbia',
'Gymnanthes',
'Jatropha',
'Maesobotrya',
'Manihot',
'Petalodiscus',
'Sauropus',
'Savia',
'Synostemon',
'Alysicarpus',
'Amicia',
'Astragalus',
'Erythrina',
'Hedysarum',
'Indigofera',
'Lupinus',
'Mucuna',
'Onobrychis',
'Oxytropis',
'Rhynchosia',
'Robinia',
'Sesbania',
'Abarema',
'Acacia',
'Adenodolichos',
'Bituminaria',
'Callerya',
'Chamaecytisus',
'Coulteria',
'Dalbergia',
'Dialium',
'Eriosema',
'Erythrostemon',
'Laburnum',
'Leptoderris',
'Lespedeza',
'Lessertia',
'Lonchocarpus',
'Medicago',
'Melilotoides',
'Millettia',
'Ormocarpopsis',
'Sanjappa',
'Spartium',
'Trifolium',
'Vicia',
'Vigna',
'Quercus',
'Exacum',
'Gentiana',
'Swertia',
'Geranium',
'Billolivia',
'Codonanthanthus',
'Didymocarpus',
'Oreocharis',
'Petrocodon',
'Primulina',
'Sphaerorrhiza',
'Ceradenia',
'Prosaptia',
'Radiogrammitis',
'Myriophyllum',
'Hanguana',
'Heliconia',
'Charybdis',
'Drimia',
'Ornithogalum',
'Scilla',
'Vera-duthiea',
'Calyptranthe',
'Cornidia',
'Heteromalla',
'Hortensia',
'Hydrangea',
'Philadelphus',
'Platycrater',
'Cosmanthus',
'Phacelia',
'Paronychia',
'Eriophyton',
'Aegiphila',
'Betonica',
'Calamintha',
'Clerodendrum',
'Clinopodium',
'Coleus',
'Eriope',
'Gmelina',
'Hemigenia',
'Kudrjaschevia',
'Lagochilus',
'Lagopsis',
'Lasemia',
'Lavandula',
'Leonurus',
'Mentha',
'Phlomoides',
'Plectranthus',
'Salvia',
'Scutellaria',
'Stachys',
'Teucrium',
'Thymus',
'Ziziphora',
'Aniba',
'Cryptocarya',
'Cubeba',
'Damburneya',
'Eschweilera',
'Aquilicia',
'Pinguicula',
'Fritillaria',
'Gagea',
'Linum',
'Bolbitis',
'Psittacanthus',
'Dendrolycopodium',
'Diphasiastrum',
'Huperzia',
'Lycopodium',
'Phlegmariurus',
'Selago',
'Lagerstroemia',
'Magnolia',
'Amorimia',
'Byrsonima',
'Stigmaphyllon',
'Tetrapterys',
'Abutilon',
'Sida',
'Alloneuron',
'Bertolonia',
'Blakea',
'Chaetogastra',
'Fordiophyton',
'Melastoma',
'Memecylon',
'Meriania',
'Miconia',
'Microlicia',
'Phyllagathis',
'Pleroma',
'Cissampelos',
'Nymphoides',
'Macrosamanea',
'Senegalia',
'Limeum',
'Eremophila',
'Morella',
'Myrica',
'Myristica',
'Ardisia',
'Beaufortia',
'Calyptranthes',
'Eugenia',
'Jambosa',
'Malleostemon',
'Metrosideros',
'Myrcia',
'Myrcianthes',
'Psidium',
'Syzygium',
'Nepenthes',
'Chionanthus',
'Fraxinus',
'Jasminum',
'Noronhia',
'Phillyrea',
'Oleandra',
'Hartmannia',
'Ocimastrum',
'Oenothera',
'Pseudo-oenothera',
'Acianthera',
'Acropera',
'Anathallis',
'Andinia',
'Angraecum',
'Aspidogyne',
'Bidoupia',
'Brachionidium',
'Bulbophyllum',
'Bunochilus',
'Campylocentrum',
'Catasetum',
'Chloraea',
'Cleisostoma',
'Coelogyne',
'Corunastylis',
'Coryanthes',
'Corybas',
'Crepidium',
'Cryptocentrum',
'Cymbidium',
'Dactylodenia',
'Dactylorhiza',
'Dasyglossum',
'Dendrobium',
'Dendrochilum',
'Eltrolexia',
'Encabarcenia',
'Encalaelia',
'Epidendrum',
'Epipactis',
'Flickingeria',
'Gastrochilus',
'Georgefara',
'Glomera',
'Gomesa',
'Gongora',
'Greenwoodiella',
'Guarischomtonia',
'Guarlaeburgkia',
'Gymnadenia',
'Habenaria',
'Hetaeria',
'Himantoglossum',
'Kodamaara',
'Laelia',
'Lepanthes',
'Liparis',
'Longhueiara',
'Masdevallia',
'Maxillaria',
'Microchilus',
'Neodryas',
'Neooreophilus',
'Neottia',
'Nervilia',
'Oligochaetochilus',
'Oliveriana',
'Ophrys',
'Orchis',
'Ottoara',
'Paphiopedilum',
'Pectinariella',
'Phalaenopsis',
'Phreatia',
'Platanthera',
'Pleione',
'Pleurothallis',
'Podochilus',
'Ponthieva',
'Pradhanara',
'Prasophyllum',
'Prosthechea',
'Pseudadenia',
'Pseudorchis',
'Pseudorhiza',
'Psyburgkia',
'Schombolaelia',
'Schomburgkia',
'Schomcatanthe',
'Schomcaulaelia',
'Schomcaulattleya',
'Schomkeria',
'Schomrhyncattleya',
'Serapias',
'Siederella',
'Sigmatostalix',
'Silvorchis',
'Speculantha',
'Stanhopea',
'Stelis',
'Stellilabium',
'Telipogon',
'Thrixspermum',
'Trichononcos',
'Trigonochilum',
'Vanda',
'Vanilla',
'Yuwengangara',
'Oxalis',
'Paeonia',
'Benstonea',
'Capnogonium',
'Corydalis',
'Glaucium',
'Papaver',
'Stylophorum',
'Ceratopteris',
'Parnassia',
'Passiflora',
'Tetrapathea',
'Pentaphragma',
'Picea',
'Pinus',
'Piper',
'Agropyron',
'Arundinella',
'Avena',
'Bouteloua',
'Bromus',
'Chloothamnus',
'Coleataenia',
'Cortaderia',
'Dendrocalamus',
'Deschampsia',
'Dichanthelium',
'Digitaria',
'Distichlis',
'Elymus',
'Eremitis',
'Eriachne',
'Fargesia',
'Festuca',
'Hymenachne',
'Iseilema',
'Koeleria',
'Merostachys',
'Orthacanthus',
'Panicum',
'Paspalum',
'Poa',
'Pseudarrhenatherum',
'Ruhooglandia',
'Saccharum',
'Schizostachyum',
'Simplicia',
'Stipa',
'Torreya',
'Tridentopsis',
'Triplasiella',
'Tripogonella',
'Trisetopsis',
'Trisetopsotrichon',
'Tritipyrum',
'Tzveleviochloa',
'Urochloa',
'Widjajachloa',
'Zaqiqah',
'Zizaniopsis',
'Jenmaniella',
'Oserya',
'Rhyncholacis',
'Acanthocladus',
'Polygala',
'Avicularia',
'Bistorta',
'Fagopyrum',
'Persicaria',
'Polygonum',
'Androsace',
'Lysimachia',
'Primula',
'Soldanella',
'Pteris',
'Frangula',
'Rhamnus',
'Smythea',
'Agrimonia',
'Alchemilla',
'Amelancus',
'Argentina',
'Aria',
'Ariamelyrus',
'Ariosorbus',
'Arisorbanchier',
'Aronia',
'Aroniaria',
'Bakeria',
'Bernullia',
'Cerasus',
'Ceropadus',
'Chabertia',
'Chamaearia',
'Chamariosorbus',
'Chavinia',
'Cotacantha',
'Cottetia',
'Crataegus',
'Crataronibus',
'Crepinia',
'Cydocydonia',
'Cydosorbus',
'Drymogaria',
'Fallania',
'Fragiphora',
'Gervasia',
'Idaeobatus',
'Malus',
'Mesaronibus',
'Photacantha',
'Potenaria',
'Potentilla',
'Prunus',
'Pyrosorbaronia',
'Pyrosorbus',
'Pyrus',
'Rosa',
'Rubus',
'Sibbaldianthe',
'Sorbacantha',
'Sorbomespilus',
'Sorbotoraria',
'Sorbus',
'Spiraea',
'Tetraglochin',
'Tormaria',
'Tormariosorbus',
'Asperula',
'Cinchona',
'Erithalis',
'Etericius',
'Foonchewia',
'Galium',
'Ixora',
'Knoxia',
'Kochummenia',
'Lasianthus',
'Leptopetalum',
'Margaritopsis',
'Mycetia',
'Oxyanthus',
'Palicourea',
'Pentagonia',
'Peponidium',
'Pseudosabicea',
'Psychotria',
'Puffia',
'Pyrostria',
'Randia',
'Ridsdalea',
'Rubia',
'Sabicea',
'Simira',
'Singaporandia',
'Spermacoce',
'Spiradiclis',
'Tetramerium',
'Amyris',
'Bellucia',
'Casimiroa',
'Glycosmis',
'Haplophyllum',
'Murraya',
'Spathelia',
'Blakwellia',
'Populus',
'Salix',
'Serjania',
'Englerophytum',
'Pouteria',
'Sideroxylon',
'Pentachlaena',
'Micranthes',
'Saxifraga',
'Anemia',
'Aphyllon',
'Castilleja',
'Erythranthe',
'Linaria',
'Lindernia',
'Neobartsia',
'Orobanche',
'Pedicularis',
'Phelipanche',
'Phelypaea',
'Scrophularia',
'Synthyris',
'Verbascum',
'Selaginella',
'Pitavia',
'Cestrum',
'Deprea',
'Jaltomata',
'Solanum',
'Symplocos',
'Camellia',
'Erotium',
'Pyrenaria',
'Amauropelta',
'Cyclosorus',
'Goniopteris',
'Lastrea',
'Parathelypteris',
'Stegnogramma',
'Thelypteris',
'Lasiosiphon',
'Pimelea',
'Brownlowia',
'Trapa',
'Tetratheca',
'Trillium',
'Typha',
'Celtis',
'Ulmus',
'Elatostema',
'Valeriana',
'Glandularia',
'Verbena',
'Anchietea',
'Rinorea',
'Viola',
'Cyphostemma',
'Vitis',
'Antrophyum',
'Erisma',
'Athyrium',
'Cystopteris',
'Deparia',
'Hypodematium',
'Zamia',
'Althenia',
'Amomum',
'Etlingera',
'Hedychium',
'Hornstedtia',
'Monolophus',
'Tetraena');

$genera=array(
'Abies',
'Acacia',
'Acampe',
'Acantholimon',
'Acanthophyllum',
'Acanthorhipsalis',
'Acanthorhiza',
'Acer',
'Aceras',
'Achaeta',
'Acharagma',
'Acidanthera',
'Acnistus',
'Acokanthera',
'Aconitum',
'Acritopappus',
'Acroglochin',
'Acropogon',
'Acrostichum',
'Actinocarya',
'Adenium',
'Adromischus',
'Aeluropus',
'Aërangis',
'Aerides',
'Aeschynanthus',
'Aethionema',
'Aframomum',
'Agathophyllum',
'Agave',
'Ageratum',
'Aglaomorpha',
'Aglaonema',
'Agnesia',
'Agrostistachys',
'Aichryson',
'Ainsliaea',
'Alafia',
'Albidella',
'Alchemilla',
'Alepidea',
'Aleuritopteris',
'Allium',
'Allophylus',
'Alnus',
'Aloe',
'Aloilanthe',
'Alotanopsis',
'Alsophila',
'Altamiranoa',
'Alyssum',
'Alyxia',
'Amaralia',
'Amaryllis',
'Amelanchier',
'Amischotolype',
'Amomum',
'Amorimia',
'Amorphophallus',
'Anacampseros',
'Anacamptis',
'Anacyclus',
'Anaheterotis',
'Anarthrophyllum',
'Anaxeton',
'Ancistrocactus',
'Anemia',
'Anemone',
'Anetanthus',
'Angolluma',
'Ania',
'Anisochilus',
'Anisopappus',
'Anisotoma',
'Anoectochilus',
'Anomalluma',
'Anomanthodia',
'Anotis',
'Anthemis',
'Anthurium',
'Anticharis',
'Antidesma',
'Antimima',
'Antithrixia',
'Antonina',
'Aphragmus',
'Aphyllorchis',
'Aplotaxis',
'Apodytes',
'Araucaria',
'Ardisia',
'Arenaria',
'Argemone',
'Argentina',
'Argyreia',
'Argyrella',
'Argyrops',
'Aria',
'Ariocarpus',
'Arisaema',
'Aristida',
'Aristolochia',
'Armeria',
'Arrojadoa',
'Artabotrys',
'Artemisia',
'Arthrocereus',
'Arundinella',
'Arundo',
'Asclepias',
'Aspidistra',
'Aspidium',
'Aspilia',
'Asplenium',
'Asterolasia',
'Astragalus',
'Astropanax',
'Astrophytum',
'Athenaea',
'Athyrium',
'Atriplex',
'Aubrieta',
'Austrocephalocereus',
'Austrocylindropuntia',
'Avonia',
'Aylostera',
'Azureocereus',
'Backebergia',
'Baillonia',
'Barbacenia',
'Barjonia',
'Barleria',
'Barreria',
'Basanacantha',
'Bassia',
'Bassovia',
'Bauhinia',
'Begonia',
'Beguea',
'Behuria',
'Beilschmiedia',
'Bellardia',
'Bellevalia',
'Berberis',
'Berteroa',
'Bidens',
'Bienertia',
'Bifora',
'Bigelowia',
'Bignonia',
'Bijlia',
'Billolivia',
'Binghamia',
'Biscutella',
'Blainvillea',
'Blastania',
'Blechnum',
'Bojeria',
'Bolboschoenus',
'Boltonia',
'Bonamia',
'Bonania',
'Boophone',
'Boottia',
'Borkhausenia',
'Borsczowia',
'Borzicactus',
'Bourreria',
'Brachystelma',
'Bradleia',
'Bredia',
'Breweria',
'Bromopsis',
'Bromus',
'Browningia',
'Brunellia',
'Buddleja',
'Buhsea',
'Bulbine',
'Bulbophyllum',
'Bulbostylis',
'Bulliarda',
'Buphane',
'Burmeistera',
'Butea',
'Butomus',
'Byrsophyllum',
'Caamembeca',
'Cactus',
'Caesalpinia',
'Caiophora',
'Calamagrostis',
'Calamus',
'Calathea',
'Calceolaria',
'Calciphilopteris',
'Calea',
'Calla',
'Calliandra',
'Callicocca',
'Calorhabdos',
'Calymmodon',
'Calyptranthes',
'Calystegia',
'Camellia',
'Cameraria',
'Camonea',
'Campanula',
'Campecarpus',
'Campomanesia',
'Campyloneurum',
'Caraipa',
'Caralluma',
'Cardamine',
'Carduus',
'Carex',
'Carmichaelia',
'Carnegiea',
'Carum',
'Caryopteris',
'Casearia',
'Cassebeeria',
'Castellanosia',
'Castilloa',
'Catanthera',
'Catopheria',
'Caucalis',
'Caudanthera',
'Caulokaempferia',
'Causonis',
'Celastrus',
'Cenia',
'Centaurea',
'Centropogon',
'Cephaëlis',
'Cephalaria',
'Cephalophyllum',
'Ceradenia',
'Cerasiocarpum',
'Cerasus',
'Ceratostylis',
'Cereus',
'Cernikara',
'Chamaecrista',
'Chamaelirium',
'Chamaenerion',
'Chaptalia',
'Chassalia',
'Cheiranthus',
'Cheiridopsis',
'Cheirontophorus',
'Cheirostylis',
'Chenopodium',
'Cherleria',
'Chimonocalamus',
'Chionanthus',
'Chionographis',
'Chlorophytum',
'Chrysanthemum',
'Chrysoglossum',
'Chrysophyllum',
'Chrysopogon',
'Cinnamomum',
'Cissus',
'Citrus',
'Cladocolea',
'Clausena',
'Claytonia',
'Cleisostoma',
'Cleistocactus',
'Clematis',
'Cleome',
'Clerodendrum',
'Clinogyne',
'Clinopodium',
'Clypeola',
'Coccoloba',
'Cochemeia',
'Cochemiea',
'Cochlioda',
'Codonopsis',
'Coelogyne',
'Conophytum',
'Conopodium',
'Conopops',
'Consolea',
'Conyza',
'Copiapoa',
'Coprosma',
'Corryocereus',
'Corunastylis',
'Corydalis',
'Corymborkis',
'Corynopuntia',
'Coryphantha',
'Cotula',
'Cotyledon',
'Coussarea',
'Cranfillia',
'Craniospermum',
'Crassula',
'Craterostigma',
'Cremnadia',
'Cremnophyton',
'Cremnosedum',
'Cremsonella',
'Crepidomanes',
'Crepis',
'Crocus',
'Croton',
'Crudia',
'Cryptocarya',
'Cryptocereus',
'Cryptolepis',
'Cryptostomum',
'Ctenitis',
'Ctenolepis',
'Cumulopuntia',
'Cunninghamia',
'Curcuma',
'Cuscuta',
'Cyathea',
'Cyathoselinum',
'Cyclopogon',
'Cycnium',
'Cylindrolobus',
'Cylindropuntia',
'Cymbidium',
'Cynomorium',
'Cypella',
'Cyphophoenix',
'Cyphosperma',
'Cypripedium',
'Cyrtandra',
'Cyrtandromoea',
'Cyrtanthus',
'Cyrtomium',
'Cystorchis',
'Cytisus',
'Dactylorhiza',
'Dalbergia',
'Danxiaorchis',
'Daphnopsis',
'Dasycephala',
'Daviesia',
'Decalobanthus',
'Decorsella',
'Deilanthe',
'Delonix',
'Delosperma',
'Delphinium',
'Dendrobium',
'Dendrocalamus',
'Dendrochilum',
'Dendrophthora',
'Dendrophylax',
'Dernia',
'Derris',
'Deschampsia',
'Deuterocohnia',
'Deyeuxia',
'Diacidia',
'Diadenium',
'Dianthera',
'Dianthus',
'Diaperia',
'Dichanthelium',
'Dichopsis',
'Didymocarpus',
'Didymopanax',
'Digitaria',
'Dimorpha',
'Dinterops',
'Dioscorea',
'Diospyros',
'Diotis',
'Diplazium',
'Diplodium',
'Diplolophium',
'Dipodium',
'Dipteryx',
'Disanthus',
'Dischidia',
'Discocactus',
'Disocactus',
'Disporum',
'Dissochaeta',
'Dissotidendron',
'Dissotis',
'Distichia',
'Distimake',
'Diuris',
'Dolichandrone',
'Dolichothele',
'Dolomiaea',
'Dombeya',
'Doratoxylon',
'Doritis',
'Dorstenia',
'Douglasia',
'Douglassia',
'Dracadinteria',
'Dracaena',
'Drepananthus',
'Drosanthemum',
'Drosera',
'Drymocallis',
'Drymophloeus',
'Dryopteris',
'Duguetia',
'Dupineta',
'Duvalia',
'Dyckia',
'Dysophylla',
'Dyssochroma',
'Eccremocactus',
'Eccremocereus',
'Echeveria',
'Echidnopsis',
'Echinofossulocactus',
'Echinomastus',
'Echinopsis',
'Echites',
'Ectadiopsis',
'Elaphoglossum',
'Elatine',
'Elatostema',
'Eleusine',
'Eleutherococcus',
'Elleanthus',
'Ellipanthus',
'Elmigera',
'Elymus',
'Elynanthus',
'Encholirium',
'Epilobium',
'Epipactis',
'Epiphyllum',
'Epithelantha',
'Eranthemum',
'Eria',
'Erica',
'Erigeron',
'Eriocaulon',
'Eriosoriopsis',
'Eriospermum',
'Eriosyce',
'Erodium',
'Erophila',
'Erythranthe',
'Erythrostemon',
'Erythroxylum',
'Espostoa',
'Etlingera',
'Eugenia',
'Eulychnia',
'Eumachia',
'Euodia',
'Euphorbia',
'Euphoria',
'Euploca',
'Eurygania',
'Eutrema',
'Evodia',
'Facheiroa',
'Fagelia',
'Fagus',
'Fallopia',
'Fatsia',
'Faujasia',
'Ferobergia',
'Ferocactus',
'Ferula',
'Ferulago',
'Festuca',
'Festulolium',
'Ficinia',
'Ficus',
'Filago',
'Fimbristylis',
'Fischeria',
'Fleischmannia',
'Flemingia',
'Foeniculum',
'Fragariastrum',
'Fragophora',
'Frailea',
'Freesia',
'Frernia',
'Freziera',
'Fritzschia',
'Gadoria',
'Galium',
'Gardenia',
'Gasteria',
'Gastonialoe',
'Gastoniella',
'Gastrodia',
'Gastrolea',
'Gastrolirion',
'Geissorhiza',
'Gentiana',
'Geosiris',
'Geranium',
'Gerbera',
'Gethyllis',
'Ghinia',
'Gilibertia',
'Ginalloa',
'Glandulicactus',
'Glaucium',
'Glebionis',
'Glenniea',
'Glinus',
'Glossocarya',
'Glossogyne',
'Glossoma',
'Glycycarpus',
'Gomphogyne',
'Gonancylis',
'Gonolobus',
'Gossypium',
'Gouania',
'Grahamia',
'Grammangis',
'Graptoladia',
'Graptopetalum',
'Grastidium',
'Grausa',
'Grewia',
'Griffinia',
'Grusonia',
'Guenthera',
'Gundelia',
'Guyonia',
'Gymnanthes',
'Gymnocactus',
'Gymnocalycium',
'Gymnolomia',
'Gynostemma',
'Gypsophila',
'Haageocereus',
'Habenaria',
'Halimione',
'Hallianthus',
'Hammeria',
'Harashuteria',
'Harbotrya',
'Harrisia',
'Haseltonia',
'Hawkesiophyton',
'Haworthia',
'Hebepetalum',
'Hedeoma',
'Hedlundia',
'Hedyotis',
'Hedysarum',
'Helianthocereus',
'Helianthus',
'Helichrysum',
'Heliocereus',
'Heliophila',
'Heliosocereus',
'Heliotropium',
'Hemithrinax',
'Heptapleurum',
'Heracleum',
'Herminium',
'Herpestis',
'Hertrichocereus',
'Hesperantha',
'Hetaeria',
'Heteranthera',
'Heterophragma',
'Heterotis',
'Heterotoma',
'Hibbertia',
'Hibiscus',
'Hieracium',
'Hippeastrum',
'Hippomarathrum',
'Hohenbergia',
'Homaloclados',
'Horkelia',
'Hormidium',
'Horsfieldia',
'Hosta',
'Hoya',
'Huberantha',
'Huernelia',
'Huernia',
'Huernianthus',
'Humiriastrum',
'Huperzia',
'Hydrolea',
'Hylocereus',
'Hymenophyllum',
'Hyphydra',
'Hypochaeris',
'Hypolepis',
'Hypserpa',
'Hyptidendron',
'Hysterionica',
'Iberis',
'Ihlenopsis',
'Impatiens',
'Inula',
'Inversodicraea',
'Iphiona',
'Ipomoea',
'Iris',
'Isachne',
'Isatis',
'Ischaemum',
'Islaya',
'Isoetes',
'Isoloma',
'Itea',
'Ixora',
'Ixyophora',
'Jaborosa',
'Jacobinia',
'Jacophyllum',
'Jasione',
'Jasminocereus',
'Julocroton',
'Jurinea',
'Justicia',
'Kalanchoe',
'Karpatiosorbus',
'Keetia',
'Kendrickia',
'Kermadecia',
'Kielmeyera',
'Klasea',
'Kleinia',
'Kobresia',
'Krainzia',
'Kroenleinia',
'Lachnostoma',
'Lactuca',
'Lagerstroemia',
'Laggera',
'Lamprachaenium',
'Landolphia',
'Lantana',
'Lapthops',
'Larix',
'Lasiadenia',
'Lasianthera',
'Lasiobema',
'Laurentia',
'Lavrania',
'Ledebouria',
'Lellingeria',
'Lemaireocereus',
'Lenophyllum',
'Lenophytum',
'Lenoveria',
'Leochilus',
'Leontodon',
'Leontopodium',
'Lepanthopsis',
'Lepidophyllum',
'Lepidotis',
'Lepismium',
'Leptaloe',
'Leptocereus',
'Leptoglossis',
'Lettsomia',
'Leucanthemopsis',
'Leucanthemum',
'Lewisia',
'Liabum',
'Libinhania',
'Ligea',
'Ligusticum',
'Lijndenia',
'Limodorum',
'Linaria',
'Lindera',
'Lindsaea',
'Linum',
'Liparis',
'Lippia',
'Lita',
'Lithops',
'Litsea',
'Lobeira',
'Lobivia',
'Lobularia',
'Lolium',
'Lophocereus',
'Loranthella',
'Loranthus',
'Loxanthocereus',
'Lucuma',
'Lunaria',
'Lycaste',
'Lycopodium',
'Lymanbensonia',
'Lysimachia',
'Lythrum',
'Macfadyena',
'Macleania',
'Macrocentrum',
'Macropharynx',
'Macrosolen',
'Macrostylis',
'Magnolia',
'Mahonia',
'Maihueniopsis',
'Majovskya',
'Malabaila',
'Mallostoma',
'Malus',
'Mammillaria',
'Mandevilla',
'Manettia',
'Mapania',
'Mappia',
'Maria',
'Markara',
'Marniera',
'Marsdenia',
'Marshallocereus',
'Massonia',
'Matricaria',
'Maxillaria',
'Mecardonia',
'Mecomischus',
'Medinilla',
'Mediocereus',
'Mediolobivia',
'Meiogyne',
'Melampodium',
'Melastomastrum',
'Melicope',
'Melocactus',
'Melocalamus',
'Memecylon',
'Mentha',
'Merremia',
'Mesembryanthemum',
'Metapolypodium',
'Metastelma',
'Metrophyllum',
'Mickelopteris',
'Miconia',
'Micranthocereus',
'Microchilus',
'Microkentia',
'Microlepia',
'Micromeria',
'Microrhynchus',
'Microstachys',
'Mimulopsis',
'Mimulus',
'Mirasolia',
'Missiessya',
'Mithridatea',
'Moerenhoutia',
'Mohenricia',
'Molineria',
'Mollugo',
'Monadenium',
'Monanthochilus',
'Monoon',
'Monotes',
'Monvillea',
'Morella',
'Morinda',
'Mostacillastrum',
'Muco',
'Mucuna',
'Murraya',
'Musa',
'Mycopteris',
'Myoxanthus',
'Myrcia',
'Myriopus',
'Myrosma',
'Myrtgerocactus',
'Myrtillocactus',
'Myrtillocereus',
'Myrtus',
'Nanalotanopsis',
'Nananopsis',
'Nannorrhops',
'Napeanthus',
'Narcissus',
'Nassauvia',
'Nauclea',
'Navajoa',
'Neckeria',
'Nectandra',
'Nemastylis',
'Neoabbottia',
'Neobinghamia',
'Neobotrydium',
'Neobuxbaumia',
'Neochilenia',
'Neocussonia',
'Neodawsonia',
'Neogomesia',
'Neohenricia',
'Neolloydia',
'Neomammillaria',
'Neomarica',
'Neonauclea',
'Neonopsis',
'Neoporteria',
'Neoraimondia',
'Neowerdermannia',
'Nepenthes',
'Nephradenia',
'Nephrodium',
'Nerine',
'Neuropeltis',
'Nidorella',
'Noccaea',
'Nopalxochia',
'Normeyera',
'Noronhia',
'Notechidnopsis',
'Notholaena',
'Notocactus',
'Nototriche',
'Nyctocereus',
'Oberonia',
'Obione',
'Ochradiscus',
'Ochroxylum',
'Ocotea',
'Odontarrhena',
'Odontochilus',
'Odontostemma',
'Oenanthe',
'Oenothera',
'Oeosporangium',
'Oldenlandia',
'Oligochaetochilus',
'Onoseris',
'Operculina',
'Ophiocaulon',
'Ophiorrhiza',
'Ophryosporus',
'Orchidantha',
'Orchis',
'Oreocereus',
'Oreocharis',
'Oreogrammitis',
'Oriastrum',
'Oritrophium',
'Ormocarpum',
'Ornithoboea',
'Ornithogalum',
'Orostachys',
'Ortegocactus',
'Orthophytum',
'Osmanthus',
'Ostodes',
'Othonna',
'Othonnopsis',
'Oxytropis',
'Oyedaea',
'Pabstiella',
'Pachgerocereus',
'Pachycymbium',
'Pachyladia',
'Pachyphytum',
'Pachypodium',
'Pachyrantia',
'Pachyrhizus',
'Pachyveria',
'Paeonia',
'Paepalanthus',
'Pagaea',
'Palicourea',
'Palmorchis',
'Papaver',
'Paphiopedilum',
'Parameria',
'Parapimpinella',
'Parathesis',
'Paris',
'Parodia',
'Paronychia',
'Parvisedum',
'Patrinia',
'Pauldopia',
'Pavonia',
'Payena',
'Pediocactus',
'Pelargonium',
'Pelea',
'Pelexia',
'Pellionia',
'Peniocereus',
'Penstemon',
'Pentaptera',
'Peperomia',
'Perebea',
'Pereskia',
'Pereskiopsis',
'Perilomia',
'Persea',
'Persicaria',
'Perula',
'Peruvocereus',
'Petagnana',
'Petrosedum',
'Peucedanum',
'Pfeiffera',
'Phagnalon',
'Phalaenopsis',
'Phalaris',
'Phanera',
'Phelipanche',
'Phellosperma',
'Philcoxia',
'Phlebocalymna',
'Phreatia',
'Phrynium',
'Phyllactis',
'Phyllagathis',
'Phyllanthus',
'Phyllobolus',
'Phyllolobium',
'Phymaspermum',
'Physematium',
'Picea',
'Picris',
'Pierrebraunia',
'Pilocereus',
'Pilosocereus',
'Pimelandra',
'Pimpinella',
'Pinalia',
'Pinguicula',
'Pinnasa',
'Pinus',
'Piper',
'Piptocarpha',
'Piptostigma',
'Planera',
'Platanthera',
'Platanus',
'Platostoma',
'Platystele',
'Platystigma',
'Pleroma',
'Pleuranthium',
'Pleurogyne',
'Pleurothallis',
'Plinia',
'Plukenetia',
'Plumatichilos',
'Podostemum',
'Polyalthia',
'Polygonum',
'Polylepis',
'Polypodiodes',
'Polypodium',
'Polyscias',
'Polytoca',
'Populus',
'Porostema',
'Porpax',
'Porphyrocodon',
'Porroglossum',
'Portulaca',
'Potamogeton',
'Potentilla',
'Poterium',
'Pouteria',
'Prangos',
'Prasophyllum',
'Praxelis',
'Premna',
'Prenanthes',
'Presliophytum',
'Prestonia',
'Primula',
'Primulina',
'Procris',
'Prosaptia',
'Prosopis',
'Protea',
'Pseudobombax',
'Pseudoespostoa',
'Pseudoheterocaryum',
'Pseudolithos',
'Pseudolobivia',
'Pseudolysimachion',
'Pseudomalcolmia',
'Pseudopectinaria',
'Pseudopilocereus',
'Pseudorhipsalis',
'Pseuduvaria',
'Psiadia',
'Psidium',
'Psilotum',
'Psorospermum',
'Psychotria',
'Pterichis',
'Pteridium',
'Pteris',
'Pterocactus',
'Pterocarya',
'Pterocaulon',
'Pteroglossa',
'Pterostylis',
'Pulsatilla',
'Puna',
'Pycnophyllopsis',
'Pyrrhocactus',
'Pyrus',
'Qualea',
'Quercus',
'Quirkara',
'Radermachera',
'Radiogrammitis',
'Randia',
'Raphidiocystis',
'Ratonia',
'Rebutia',
'Rennellia',
'Reseda',
'Rhagadiolus',
'Rhaphidophora',
'Rhinorchis',
'Rhipsalis',
'Rhizocephalum',
'Rhodiola',
'Rhodocalyx',
'Rhododendron',
'Rhombocaria',
'Rhopaloblaste',
'Rhopalota',
'Rhynchosia',
'Rhynchospora',
'Rhyticarpus',
'Rhytidocaulon',
'Rinzia',
'Rittera',
'Ritterocereus',
'Robiquetia',
'Rodriguezia',
'Rohdea',
'Rorippa',
'Roseocactus',
'Rottboellia',
'Roubieva',
'Roulinia',
'Rubus',
'Sabal',
'Sabatia',
'Sabulina',
'Saelanthus',
'Salix',
'Salsola',
'Salvia',
'Samaipaticereus',
'Sansevieria',
'Saprosma',
'Saracha',
'Sarcocolla',
'Sarcoglottis',
'Sarcosperma',
'Sarcostemma',
'Satyria',
'Satyrium',
'Saussurea',
'Sauvagesia',
'Saxifraga',
'Scaphyglottis',
'Schefflera',
'Schizoglossum',
'Schizotrichia',
'Schizozygia',
'Schlumbergera',
'Schoenoplectiella',
'Schoenorchis',
'Schoenus',
'Schollera',
'Schomburgkia',
'Schwenkfelda',
'Sclerocactus',
'Sclerocarpus',
'Scleromitrion',
'Scolopia',
'Scorzonera',
'Scrophularia',
'Sebastiania',
'Sedeveria',
'Selaginella',
'Selenicereus',
'Selinum',
'Semenovia',
'Senebiera',
'Senecio',
'Serenoa',
'Serjania',
'Sesuvium',
'Setiechinopsis',
'Shivparvatia',
'Shorea',
'Siccobaccatus',
'Sida',
'Siderasis',
'Silene',
'Siler',
'Simira',
'Sinningia',
'Sinocrassula',
'Siphonia',
'Soehrenopsis',
'Soehrensia',
'Solanum',
'Sonerila',
'Sophoclesia',
'Sorbomeles',
'Sorbus',
'Spathalea',
'Spergularia',
'Sphaerotorrhiza',
'Spielmannia',
'Spigelia',
'Spinacea',
'Spinulum',
'Spiradiclis',
'Spiraea',
'Stadmania',
'Stapelia',
'Staphylea',
'Statice',
'Stellilabium',
'Stemodia',
'Stenocline',
'Stephanotis',
'Stereospermum',
'Stevenia',
'Stipa',
'Stomatricia',
'Strempeliopsis',
'Strobilanthes',
'Strobocalyx',
'Strombosia',
'Strophocactus',
'Strophocereus',
'Struthiopteris',
'Stultitia',
'Stutzia',
'Stylotrichium',
'Styphelia',
'Suaeda',
'Subpilocereus',
'Sulcolluma',
'Sulcorebutia',
'Swartzia',
'Symphonia',
'Syzygium',
'Tacipetalum',
'Taciphytum',
'Taeniophyllum',
'Tainia',
'Tanquilos',
'Taraxacum',
'Tectona',
'Telipogon',
'Tephrocactus',
'Tephroseris',
'Terminalia',
'Ternstroemia',
'Tetracera',
'Tetramicra',
'Tetranthera',
'Tetrastigma',
'Tetratheca',
'Teucrium',
'Thalictrum',
'Thaumatococcus',
'Thelocactus',
'Thelypteris',
'Theodorea',
'Thinouia',
'Thompsonella',
'Thompsophytum',
'Thompsosedum',
'Thompsoveria',
'Thouinia',
'Thymus',
'Tillaea',
'Tillandsia',
'Tinguarra',
'Titymaotus',
'Tormentilla',
'Torminalis',
'Torularia',
'Toumeya',
'Tourrettia',
'Tradescantia',
'Trevesia',
'Tricera',
'Trichilia',
'Trichocereus',
'Trichomanes',
'Trichosalpinx',
'Trigonella',
'Trigonostemon',
'Trimezia',
'Trisciadia',
'Tritonia',
'Trochomeria',
'Tsaiodendron',
'Tupistra',
'Turbinicarpus',
'Turnera',
'Turraea',
'Tylecodon',
'Urania',
'Urceola',
'Urochilus',
'Urochloa',
'Urostachys',
'Urtica',
'Urvillea',
'Uvaria',
'Vaccinium',
'Valeriana',
'Vananopsis',
'Varronia',
'Vasconcellea',
'Vatica',
'Vatricania',
'Ventilago',
'Verbascum',
'Vernonia',
'Veronica',
'Vicatia',
'Vicia',
'Vicoa',
'Vietnamocasia',
'Viguiera',
'Villadia',
'Villamilla',
'Villeveria',
'Vincetoxicum',
'Virgilia',
'Vitis',
'Vlokia',
'Vochysia',
'Vrydagzynea',
'Walkera',
'Waltillia',
'Warneckea',
'Weberocereus',
'Wedelia',
'Weingartia',
'Welfia',
'Werckleocereus',
'Werneria',
'Whitesloaniopsis',
'Woodsia',
'Woodsiopsis',
'Wrightia',
'Wuacanthus',
'Wyethia',
'Xanthe',
'Xanthocephalum',
'Xanthomyrtus',
'Xanthostemon',
'Xenostegia',
'Xerochrysum',
'Ximenia',
'Xylophragma',
'Xylopia',
'Xyris',
'Yoania',
'Yucca',
'Zanthoxylum',
'Zexmenia',
'Ziziphora',
'Zygosicyos');

//$genera = array('Billolivia');

foreach ($genera as $genus)
{
	$names = array();
	
	$sql = 'SELECT * FROM names WHERE `Genus` = "' . $genus . '" AND cluster_id IS NULL';

	$result = $db->Execute($sql);
	if ($result == false) die("failed [" . __LINE__ . "]: " . $sql);
	while (!$result->EOF) 
	{
		$record = new stdclass;
		$record->id = $result->fields['Id'];
		$record->name = $result->fields['Full_name_without_family_and_authors'];
		$record->authors = $result->fields['Authors'];
		$record->year = $result->fields['Publication_year_full'];
		$record->rank = $result->fields['Rank'];
		
		if (preg_match('/^(?<year>[0-9]{4})/', $record->year, $m))
		{
			$record->year = $m['year'];
		}
		
		if (preg_match('/\d+-(?<source>\d+)$/', $record->id, $m))
		{
			$record->source = $m['source'];
		}
		
		$names[] = $record;
		$result->MoveNext();	
	}


	//print_r($names);
	
	$n = count($names);
	if ($n > 1)
	{
	
		for ($i = 0; $i < $n; $i++)
		{
			makeset($i);
		}

		for ($i = 1; $i < $n; $i++)
		{
			for ($j = 0; $j < $i; $j++)
			{
				$v1 = $names[$i]->name . ' ' . $names[$i]->authors . ' ' . $names[$j]->rank;
				$v2 = $names[$j]->name . ' ' . $names[$j]->authors . ' ' . $names[$j]->rank;

				if ($v1 == $v2) {
					union($i, $j);
				}
			}
		}
	
		$clusters = array();
	
		for ($i = 0; $i < $n; $i++)
		{
			$p = $parents[$i];
		
			if (!isset($clusters[$p]))
			{
				$clusters[$p] = array();
			}
			$clusters[$p][] = $i;
		}
		
		//print_r($clusters);
		
		foreach ($clusters as $k => $v)
		{
			$cluster_id = $names[$v[0]]->id;
			if (count($v) == 1)
			{
				echo "UPDATE `names` SET `cluster_id`='$cluster_id' WHERE Id='" . $names[$v[0]]->id . "';" . "\n";
			}
			else
			{
				//echo "-- cluster\n";
				foreach ($v as $i)
				{
					if ($names[$i]->source == 1)
					{
						$cluster_id = $names[$i]->id;
					}
				}
				echo "-- $cluster_id\n";
				
				foreach ($v as $i)
				{
					//echo $names[$i]->source . ' ' . $names[$i]->name . ' ' . $names[$i]->authors . ' ' . $names[$j]->rank . "\n";
					
					echo "UPDATE `names` SET `cluster_id`='$cluster_id' WHERE Id='" . $names[$i]->id . "';" .  " -- " . $names[$i]->name . "\n";
				}
				echo "-- \n";
			}
					
		}
	}
	



}

?>